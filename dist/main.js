(()=>{"use strict";const e={quiz:{},currQuestion:"",currOptions:[],progress:5,optionsMap:["A","B","C","D"],score:0,answers:{selected:[0,"",!1],right:[0,""],answered:!1},setRightAnswer(){this.answers.right[1]=this.quiz.questions[e.progress].answer,this.answers.right[0]=this.currOptions.findIndex((e=>e===this.getRightAnswer()))},getRightAnswer(){return this.answers.right[1]},setSelectedAnswer(e,t){this.answers.selected[0]=+e,this.answers.selected[1]=t}};class t{_data;render(e){if(console.log(e),!e)return;this._data=e;const t=this._generateMarkup();console.log("markup"),console.log(t),this.clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}update(){}renderError(){console.log("error")}clear(){this._parentElement.innerHTML=""}}const s=new class extends t{_parentElement=document.querySelector(".main__options");_btnElement;_optionElement;_selectedOption;_allButtons;_allOptions;_data;initElements(){this._allButtons=this._parentElement.querySelectorAll(".selection"),this._allOptions=this._parentElement.querySelectorAll(".selection-option")}_generateMarkup(){return console.log(this._data),`\n        ${this._data.currOptions.map(((e,t)=>`<button class="selection type-heading-s" data-option="${t}">\n        <div\n          class="selection-option selection-option--idle type-heading-s">\n          ${this._data.optionsMap[t]}\n        </div>\n        ${function(e){try{if("string"==typeof e){const t=["<",">","&"],s=["&lt;","&gt;","&amp;"];return e.split("").map((e=>-1===t.indexOf(e)?e:s[t.indexOf(e)])).join("")}return e}catch(e){}}(e)}\n      </button>`)).join()}\n       <button class="btn btn-submit type-heading-s">Submit answer</button>`}resetClasses(){this._allButtons.forEach((e=>e.className="selection type-heading-s")),this._allOptions.forEach((e=>e.className="selection-option selection-option--idle type-heading-s"))}toggleState(e,t){this._allButtons[e].classList.toggle(`selection--${t}`),this._allOptions[e].classList.toggle(`selection-option--${t}`)}addHandlerSelectOption(e){this._parentElement.addEventListener("click",function(t){if(this.initElements(),this._btnElement=t.target.closest(".selection"),this._optionElement=t.target.querySelector(".selection-option"),!this._btnElement||!this._optionElement)return;const s=this._btnElement.dataset.option,n=this._btnElement.innerText.slice(2).trim();e(n,s)}.bind(this))}renderCorrectAnswer(e,t){const s=this._allButtons[e],n=this._allButtons[t],i=document.querySelector(".btn-submit");n.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" class="selection-tick" fill="none" viewBox="0 0 40 40"><path fill="#26D782" d="M20 5a15 15 0 1 1 0 30 15 15 0 0 1 0-30Zm0 2.5a12.5 12.5 0 1 0 0 25 12.5 12.5 0 0 0 0-25Zm-1.875 15.105L25.3 15.41a1.25 1.25 0 0 1 1.915 1.593l-.145.174-8.06 8.08a1.25 1.25 0 0 1-1.595.148l-.175-.145-4.375-4.375a1.25 1.25 0 0 1 1.595-1.913l.175.143 3.49 3.49Z"/></svg>'),e!=t&&s.insertAdjacentHTML("beforeend",'<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" class="selection-tick" fill="none" viewBox="0 0 40 40"><path fill="#EE5454" d="M20 5a15 15 0 1 1 0 30 15 15 0 0 1 0-30Zm0 2.5a12.5 12.5 0 1 0 0 25 12.5 12.5 0 0 0 0-25Zm-5.402 7.415.142-.175a1.25 1.25 0 0 1 1.595-.143l.175.143L20 18.233l3.49-3.493a1.25 1.25 0 0 1 1.595-.143l.175.143a1.25 1.25 0 0 1 .142 1.595l-.142.175L21.767 20l3.493 3.49a1.25 1.25 0 0 1 .142 1.595l-.142.175a1.25 1.25 0 0 1-1.595.142l-.175-.142L20 21.767l-3.49 3.493a1.25 1.25 0 0 1-1.595.142l-.175-.142a1.25 1.25 0 0 1-.143-1.595l.143-.175L18.233 20l-3.493-3.49a1.25 1.25 0 0 1-.143-1.595Z"/></svg>'),this._allButtons.forEach((e=>e.classList.add("selection-disabled"))),i.innerText="Next Question",i.classList.replace("btn-submit","btn-next")}addHandlerSelectTopic(e){this._parentElement.addEventListener("click",(function(t){const s=t.target.closest(".selection");if(!s)return;const n=+s.querySelector(".selection-option").dataset.topic;(n||0===n)&&e(n)}))}addHandlerRenderSubmitAnswer(e){this._parentElement.addEventListener("click",function(t){t.target.closest(".btn-submit")&&e()}.bind(this))}addHandlerNextQuestion(e){this._parentElement.addEventListener("click",(function(t){const s=t.target.closest(".btn-next");s&&s.addEventListener("click",(function(t){e()}))}))}},n=new class extends t{_parentElement=document.querySelector(".main__question");_data;_generateMarkup(){return`<div class="main__question-heading">\n      <div class="main__question-sub-heading">\n            <p class="type-body-s">Question ${this._data.progress+1} of ${this._data.quiz.questions.length}</p>\n          </div>    \n            <h2 class="type-heading-l">\n              ${this._data.currQuestion}\n            </h2>\n          </div>\n          \n          <div class="main__question-progress-bar">\n            <div class="main__question-progress-bar-progress"></div>\n          </div>`}updateProgressBar(){const e=document.querySelector(".main__question-progress-bar-progress"),t=(this._data.progress+1)/this._data.quiz.questions.length*100;e.style.setProperty("width",`${t}%`)}},i=new class extends t{_parentElement=document.querySelector(".main");_data;_generateMarkup(){return console.log("generate markup resultsview:",this._data),`\n    <div class="main__question">\n          <div class="main__question-heading">\n            <h2 class="type-heading-l">\n            Quiz completed\n              <span class="type-regular">You scored...</span>\n            </h2>\n          </div>\n        </div>\n        <div class="main__result">\n        <img src=${this._data.quiz.icon} alt="${this._data.quiz.title} Icon" />\n           <h4 class="type-heading-s" class="main__result-heading">${this._data.quiz.title}</h4>\n           <h1 class="type-display">${this._data.score}</h1>\n           <div class="main__result-sub-heading">\n            <p class="type-body-s">out of ${this._data.quiz.question.length}</p>\n          </div>\n          \n          \n        </div>`}},r=function(){try{if(null===e.progress)return;if(e.progress===e.quiz.questions.length)return void a();console.log("continuing"),e.currQuestion=e.quiz.questions[e.progress].question,e.currOptions=e.quiz.questions[e.progress].options,e.answers.answered=e.answers.selected[2]=!1,n.render(e),n.updateProgressBar(e),s.render(e),console.log(e)}catch(e){console.error(e)}},a=function(){try{console.log("calling results view"),i.render(e)}catch(e){}};s.addHandlerSelectTopic((async function(t){try{await async function(t){const{quizzes:s}=await async function(){try{const e=await fetch("../data.json");return await e.json()}catch(e){}}();e.quiz=s[t]}(+t),e.progress=0,r(e.progress)}catch(e){console.error(e)}})),s.addHandlerSelectOption((function(t,n){null===e.progress||e.answers.answered||(e.answers.selected[2]=!0,console.log(e.answers.selected[2]),s.resetClasses(),e.setSelectedAnswer(n,t),s.toggleState(n,"active"))})),s.addHandlerRenderSubmitAnswer((function(){const t=e.answers;t.answered||(t.selected[2]?(e.setRightAnswer(),e.answers.answered=!0,e.progress+=1,e.getRightAnswer()===e.answers.selected[1]&&(e.score+=1,1)?(s.resetClasses(),s.toggleState(t.selected[0],"picked-correct")):(s.resetClasses(),s.toggleState(t.selected[0],"picked-incorrect"),s.toggleState(t.right[0],"picked-correct")),s.renderCorrectAnswer(t.selected[0],t.right[0])):s.renderError())})),s.addHandlerNextQuestion((function(){e.answers.answered&&(console.log("next"),r())}))})();